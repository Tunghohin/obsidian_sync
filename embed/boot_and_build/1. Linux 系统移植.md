

## 1.1 基本流程

#### 1.1.1 uboot

1. 获取开发板厂商的 uboot 代码
2. 安装 ncurses 库
```sh
sudo apt install libncurses5-dev
```
3. 编译uboot
```sh
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- distclean
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- mx6ull_14x14_ddr512_emmc_defconfig
make V=1 ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- -j4 # V=1为编译过程信息输出级别
```
4. 将编译完成的 u-boot.bin 烧写到 sd 卡，选择从 sd 卡 boot
5. 用网线连接路由器与主机，并配置 uboot 网络
```
# host
ifconfig #查看主机ip

# target uboot
setenv ipaddr 192.168.0.105 # 必须和主机在同一网段，并且无冲突
setenv ethaddr b8:ae:1d:01:00:00 # 必须无冲突
setenv serverip 192.168.0.101 # 主机ip
saveenv
```
6.  配置主机 tftp 环境
```sh
sudo apt-get install tftp-hpa tftpd-hpa
sudo apt-get install xinetd

mkdir /path_to_tftp/tftp
chmod 777 /path_to_tftp/tftp

sudo vim /etc/xinetd.d/tftp
#server tftp
#{
#    socket_type = dgram
#    protocol = udp
#    wait = yes
#    user = root
#    server = /usr/sbin/in.tftpd
#    server_args = -s /path_to_tftp/tftp
#    disable = no
#    per_source = 11
#    cps = 100 2
#    flags = IPv4
#}

sudo service tftpd-hpa start

sudo vim /etc/default/tftpd-hpa
#TFTP_USERNAME="tftp"
#TFTP_DIRECTORY="/path_to_tftp/tftp"
#TFTP_ADDRESS=":69"
#TFTP_OPTIONS="-l -c -s"

sudo service tftpd-hpa restart # 并将镜像文件移到 tftp 文件夹

# target uboot
tftp 80800000 zImage
tftp 83000000 imx6ull-14x14-emmc-7-1024x600-c.dtb
bootz 80800000 - 83000000
```
#### 1.1.2 build

1. 编译内核之前需要先安装 lzop 库

2. 编译内核
```sh
#!/bin/sh
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- distclean
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- imx_v7_defconfig
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- menuconfig
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- all -j4
```
* distclean：清理工程
* xxx_defconfig：工程配置文件
* menuconfig：图形化配置

编译出来的 zImage 在 ```arch/arm/boot```，设备树在 ```arch/arm/boot/dtc```


#### 1.1.3 rootfs



